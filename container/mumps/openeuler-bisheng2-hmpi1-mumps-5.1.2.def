BootStrap: docker
From: openeuler/openeuler

%environment
    source /etc/profile || true
    source /etc/profile.d/modules.sh
    cd $JARVIS_ROOT
    source init.sh
    source env.sh

%post
    # Install the necessary development environment
    yum install -y environment-modules git wget unzip make flex tar
    source /etc/profile || true
    git config --global http.sslVerify false
    git clone https://gitee.com/openeuler/hpcrunner
    cd hpcrunner
    source ./init.sh
    ./jarvis -i
    # Switch config
    ./jarvis -use templates/mumps/5.1.2/data.mumps.arm.cpu.config
    # download dependency
    ./jarvis -d
    # install dependency
    ./jarvis -dp
    # build mumps
    ./jarvis -b
    # run test
    ./jarvis -r
    # clean cache and downloads directory
    yum clean all
    rm -rf downloads

%labels
    Author Zu